<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>実データインポート</title>
    <style>
        body {
            font-family: sans-serif;
            padding: 20px;
            max-width: 1000px;
            margin: 0 auto;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        .data-section {
            margin: 20px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 5px;
        }
        .success {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
        }
        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #5a67d8;
        }
        textarea {
            width: 100%;
            height: 300px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>📊 note.com 実データインポート</h1>
        
        <div class="data-section">
            <h2>現在のデータ（2025年8月11日〜8月17日）</h2>
            <p>全体ビュー: <strong>158</strong> | コメント: <strong>0</strong> | スキ: <strong>11</strong></p>
        </div>
        
        <div class="data-section">
            <h3>記事データ（CSV形式）</h3>
            <textarea id="csvData">【2025年版】CPUコア数の選び方 - 4コアで十分？16コア必要？用途別完全ガイド, 22, 0, 0
冷たいGPT-5sを理想の恋人&親友に変える禁断テクニック大公開！, 22, 0, 2
OpenAI初のオープンソースモデル「GPT-OSS-20b」徹底解説 - 自宅PCで動く, 17, 0, 1
Claude Code徹底解説 - ターミナルに住むAIが変える開発現場, 13, 0, 2
禁酒34日目で分かったこと, 9, 0, 0
サッカーファンが最強GPU情報源だったRTX5090を25%安く買える可能性が見えた記入, 8, 0, 0
AIメガネがないと出世できない時代, 8, 0, 0</textarea>
            
            <p>形式: タイトル, ビュー数, コメント数, スキ数</p>
        </div>
        
        <button onclick="clearCurrentData()">現在のデータをクリア</button>
        <button onclick="importData()">データをインポート</button>
        <button onclick="viewCurrentData()">現在のデータを確認</button>
        <button onclick="window.open('http://localhost:8080/posts/index.html', '_blank')">投稿管理ページを開く</button>
        
        <div id="result"></div>
    </div>

    <script>
        function clearCurrentData() {
            if (confirm('現在のデータを全て削除しますか？')) {
                localStorage.removeItem('posts-data');
                document.getElementById('result').innerHTML = '<div class="success">✅ データをクリアしました</div>';
            }
        }
        
        function importData() {
            const csvText = document.getElementById('csvData').value;
            const lines = csvText.trim().split('\n');
            const posts = [];
            
            lines.forEach(line => {
                const parts = line.split(',').map(p => p.trim());
                if (parts.length >= 4) {
                    posts.push({
                        id: Date.now() + Math.random(),
                        title: parts[0],
                        url: `https://note.com/yutapii/n/n${Math.random().toString(36).substr(2, 9)}`,
                        date: new Date().toISOString().split('T')[0],
                        views: parseInt(parts[1]) || 0,
                        comments: parseInt(parts[2]) || 0,
                        likes: parseInt(parts[3]) || 0,
                        status: 'published'
                    });
                }
            });
            
            // 既存のデータを取得
            const existingData = localStorage.getItem('posts-data');
            let allPosts = existingData ? JSON.parse(existingData) : [];
            
            // 新しいデータを追加
            allPosts = [...posts, ...allPosts];
            
            // 保存
            localStorage.setItem('posts-data', JSON.stringify(allPosts));
            
            document.getElementById('result').innerHTML = `
                <div class="success">
                    ✅ ${posts.length}件のデータをインポートしました<br>
                    総投稿数: ${allPosts.length}件<br>
                    総ビュー数: ${allPosts.reduce((sum, p) => sum + p.views, 0)}<br>
                    総スキ数: ${allPosts.reduce((sum, p) => sum + p.likes, 0)}
                </div>
            `;
        }
        
        function viewCurrentData() {
            const data = localStorage.getItem('posts-data');
            if (data) {
                const posts = JSON.parse(data);
                const totalViews = posts.reduce((sum, p) => sum + (p.views || 0), 0);
                const totalLikes = posts.reduce((sum, p) => sum + (p.likes || 0), 0);
                
                document.getElementById('result').innerHTML = `
                    <div class="data-section">
                        <h3>現在のLocalStorageデータ</h3>
                        <p>投稿数: ${posts.length}件</p>
                        <p>総ビュー数: ${totalViews}</p>
                        <p>総スキ数: ${totalLikes}</p>
                        <h4>最新5件:</h4>
                        <ul>
                            ${posts.slice(0, 5).map(p => `
                                <li>${p.title.substring(0, 30)}... (${p.views}ビュー, ${p.likes}スキ)</li>
                            `).join('')}
                        </ul>
                    </div>
                `;
            } else {
                document.getElementById('result').innerHTML = '<div class="data-section">データがありません</div>';
            }
        }
    </script>
</body>
</html>