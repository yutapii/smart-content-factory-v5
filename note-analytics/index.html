<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>note.com Analytics Editor - „Çπ„Ç≠/PVÁ∑®ÈõÜ„ÉÑ„Éº„É´ | SCF V5</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans JP', sans-serif;
            background: linear-gradient(135deg, #00d2a0 0%, #00a968 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        h1 {
            text-align: center;
            margin-bottom: 10px;
            color: #333;
            font-size: 2em;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
        }

        .sync-bar {
            background: #f0f9ff;
            border: 1px solid #0ea5e9;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .sync-status {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .sync-btn {
            background: #0ea5e9;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }

        .stats-summary {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid #bae6fd;
        }

        .stat-label {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 1.8em;
            font-weight: bold;
            color: #0284c7;
        }

        .tools-bar {
            background: #fef3c7;
            border: 1px solid #fbbf24;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .tool-btn {
            padding: 8px 15px;
            border: 1px solid #f59e0b;
            background: white;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .tool-btn:hover {
            background: #fbbf24;
            color: white;
        }

        .articles-table {
            width: 100%;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        thead {
            background: #f8fafc;
            border-bottom: 2px solid #e2e8f0;
        }

        th {
            padding: 15px;
            text-align: left;
            font-weight: bold;
            color: #475569;
            font-size: 0.9em;
        }

        tbody tr {
            border-bottom: 1px solid #f1f5f9;
            transition: all 0.2s;
        }

        tbody tr:hover {
            background: #f8fafc;
        }

        td {
            padding: 12px 15px;
        }

        .article-title {
            font-weight: bold;
            color: #334155;
            max-width: 400px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .article-date {
            color: #64748b;
            font-size: 0.9em;
        }

        .editable-input {
            width: 80px;
            padding: 5px 8px;
            border: 1px solid #cbd5e1;
            border-radius: 4px;
            text-align: center;
            font-size: 0.9em;
        }

        .editable-input:focus {
            outline: none;
            border-color: #0ea5e9;
            box-shadow: 0 0 0 3px rgba(14,165,233,0.1);
        }

        .edit-btn {
            padding: 5px 10px;
            background: #10b981;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85em;
        }

        .edit-btn:hover {
            background: #059669;
        }

        .bulk-edit-panel {
            background: #f0fdf4;
            border: 1px solid #86efac;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            display: none;
        }

        .bulk-edit-panel.active {
            display: block;
        }

        .bulk-controls {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .bulk-input {
            padding: 8px 12px;
            border: 1px solid #86efac;
            border-radius: 5px;
            width: 150px;
        }

        .apply-btn {
            background: #22c55e;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }

        .export-section {
            margin-top: 30px;
            padding: 20px;
            background: #fef3c7;
            border-radius: 10px;
            text-align: center;
        }

        .export-btn {
            padding: 12px 30px;
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            margin: 0 10px;
        }

        .export-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(245,158,11,0.4);
        }

        .checkbox-col {
            width: 40px;
        }

        .article-checkbox {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        @media (max-width: 968px) {
            .stats-summary {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .article-title {
                max-width: 200px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìä note.comË®ò‰∫ã„Éá„Éº„Çø„Éô„Éº„ÇπÁ∑®ÈõÜ„ÉÑ„Éº„É´</h1>
        <p class="subtitle">RSS: note.com/yutapii/rss „Åã„Çâ„Éá„Éº„Çø„ÇíÂèñÂæó„ÉªÁ∑®ÈõÜ</p>

        <div class="sync-bar">
            <div class="sync-status">
                <span>üîÑ ÊúÄÁµÇÂêåÊúü: 2025Âπ¥8Êúà11Êó• 13:08</span>
                <span>ÔΩú</span>
                <span>üì∞ Ë®ò‰∫ãÊï∞: 20‰ª∂</span>
            </div>
            <button class="sync-btn" onclick="syncRSS()">RSS„Åã„ÇâÊõ¥Êñ∞</button>
        </div>

        <div class="stats-summary">
            <div class="stat-card">
                <div class="stat-label">Á∑èPVÊï∞</div>
                <div class="stat-value" id="totalPV">259</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Á∑è„Çπ„Ç≠Êï∞</div>
                <div class="stat-value" id="totalLikes">20</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Âπ≥ÂùáPV</div>
                <div class="stat-value" id="avgPV">12.9</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Âπ≥Âùá„Çπ„Ç≠</div>
                <div class="stat-value" id="avgLikes">1.0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">„Çπ„Ç≠Áéá</div>
                <div class="stat-value" id="likeRate">7.7%</div>
            </div>
        </div>

        <div class="tools-bar">
            <button class="tool-btn" onclick="toggleBulkEdit()">üîß ‰∏ÄÊã¨Á∑®ÈõÜ</button>
            <button class="tool-btn" onclick="randomizeData()">üé≤ „É©„É≥„ÉÄ„É†ÁîüÊàê</button>
            <button class="tool-btn" onclick="resetData()">üîÑ „É™„Çª„ÉÉ„Éà</button>
            <button class="tool-btn" onclick="sortByPV()">üìä PVÈ†Ü</button>
            <button class="tool-btn" onclick="sortByLikes()">‚ù§Ô∏è „Çπ„Ç≠È†Ü</button>
            <button class="tool-btn" onclick="sortByDate()">üìÖ Êó•‰ªòÈ†Ü</button>
        </div>

        <div class="bulk-edit-panel" id="bulkEditPanel">
            <h3 style="margin-bottom: 15px;">üîß ÈÅ∏Êäû„Åó„ÅüË®ò‰∫ã„Çí‰∏ÄÊã¨Á∑®ÈõÜ</h3>
            <div class="bulk-controls">
                <label>PVÊï∞: <input type="number" class="bulk-input" id="bulkPV" placeholder="100"></label>
                <label>„Çπ„Ç≠Êï∞: <input type="number" class="bulk-input" id="bulkLikes" placeholder="10"></label>
                <button class="apply-btn" onclick="applyBulkEdit()">ÈÅ©Áî®</button>
                <button class="tool-btn" onclick="toggleBulkEdit()">„Ç≠„É£„É≥„Çª„É´</button>
            </div>
        </div>

        <div class="articles-table">
            <table>
                <thead>
                    <tr>
                        <th class="checkbox-col">
                            <input type="checkbox" id="selectAll" onchange="toggleSelectAll()">
                        </th>
                        <th>Ë®ò‰∫ã„Çø„Ç§„Éà„É´</th>
                        <th>ÂÖ¨ÈñãÊó•</th>
                        <th>PVÊï∞</th>
                        <th>„Çπ„Ç≠Êï∞</th>
                        <th>„Çπ„Ç≠Áéá</th>
                        <th>Êìç‰Ωú</th>
                    </tr>
                </thead>
                <tbody id="articlesBody">
                    <!-- Ë®ò‰∫ã„Éá„Éº„Çø„Åå„Åì„Åì„Å´ÊåøÂÖ•„Åï„Çå„Åæ„Åô -->
                </tbody>
            </table>
        </div>

        <div class="export-section">
            <h3 style="margin-bottom: 15px;">üì• „Éá„Éº„Çø„Ç®„ÇØ„Çπ„Éù„Éº„Éà</h3>
            <button class="export-btn" onclick="exportJSON()">JSONÂΩ¢Âºè</button>
            <button class="export-btn" onclick="exportCSV()">CSVÂΩ¢Âºè</button>
            <button class="export-btn" onclick="exportMarkdown()">MarkdownÂΩ¢Âºè</button>
        </div>
    </div>

    <script>
        // Ë®ò‰∫ã„Éá„Éº„ÇøÔºàRSS„Åã„ÇâÂèñÂæó„Åó„Åü„ÇÇ„ÅÆ + Á∑®ÈõÜÂèØËÉΩ„Å™PV/„Çπ„Ç≠Ôºâ
        let articles = [
            {
                title: "Á¶ÅÈÖí34Êó•ÁõÆ„ÅßÂàÜ„Åã„Å£„Åü„Åì„Å®",
                url: "https://note.com/yutapii/n/n_kinshu34",
                date: "2025/08/11",
                pv: 620,
                likes: 7,
                comments: 0
            },
            {
                title: "ÂõûÂæ©„ÅÆÂë™Êñá„ÅØ„Çπ„Ç≠‚ù§Ô∏è Âçó‰ºäË±ÜÁ∑® JU-ZA CYCLE YADO",
                url: "https://note.com/yutapii/n/n_minamiizu",
                date: "2025/08/10",
                pv: 354,
                likes: 19,
                comments: 0
            },
            {
                title: "„Äê2025Âπ¥Áâà„ÄëCPU„Ç≥„Ç¢Êï∞„ÅÆÈÅ∏„Å≥Êñπ - 4„Ç≥„Ç¢„ÅßÂçÅÂàÜÔºü16„Ç≥„Ç¢ÂøÖË¶ÅÔºüÁî®ÈÄîÂà•ÂÆåÂÖ®„Ç¨„Ç§„Éâ",
                url: "https://note.com/yutapii/n/n2bfe27f1e085",
                date: "2025/08/07",
                pv: 226,
                likes: 2,
                comments: 0
            },
            {
                title: "Á¶ÅÈÖíÔºñÊó•ÁõÆ„Å´ÊÄù„ÅÜ„Åì„Å®",
                url: "https://note.com/yutapii/n/n_kinshu6",
                date: "2025/08/09",
                pv: 199,
                likes: 0,
                comments: 2
            },
            {
                title: "ÂÅ•Â∫∑„ÅåËª¢ËêΩ„Åô„ÇãÊôÇ„ÄÄ„É©„É≥„Éä„ÉºÁ∑®„ÄÄ1Ë©±",
                url: "https://note.com/yutapii/n/n_runner1",
                date: "2025/08/08",
                pv: 181,
                likes: 7,
                comments: 0
            },
            {
                title: "„Éó„É≠„Éï„Ç£„Éº„É´",
                url: "https://note.com/yutapii/n/n_profile",
                date: "2025/08/07",
                pv: 165,
                likes: 5,
                comments: 0
            },
            {
                title: "ÂÅ•Â∫∑„ÅåËª¢ËêΩ„Åô„ÇãÊôÇ7Ë©±",
                url: "https://note.com/yutapii/n/n_health7",
                date: "2025/08/06",
                pv: 135,
                likes: 24,
                comments: 2
            },
            {
                title: "„Éí„É©„É°Á≠ã„ÅÆËÇâÈõ¢„Çå„ÄÄ(2ÂõûÁõÆ„ÅÆË®∫ÂØü)",
                url: "https://note.com/yutapii/n/n_hirame2",
                date: "2025/08/05",
                pv: 128,
                likes: 5,
                comments: 0
            },
            {
                title: "ÂõûÂæ©„ÅÆÂë™Êñá„ÅØ„Éô„Éõ„Ç§„ÉüÔºÅ„ÄÄÈÄÄÈô¢ÂæåÂàùÁöáÂ±Ö„É©„É≥Á∑®",
                url: "https://note.com/yutapii/n/n_behoimi",
                date: "2025/08/04",
                pv: 119,
                likes: 9,
                comments: 0
            },
            {
                title: "ÂÅ•Â∫∑„ÅåËª¢ËêΩ„Åô„ÇãÊôÇ3Ë©±",
                url: "https://note.com/yutapii/n/n_health3",
                date: "2025/08/03",
                pv: 117,
                likes: 14,
                comments: 3
            },
            {
                title: "ÂÅ•Â∫∑„ÅåËª¢ËêΩ„Åô„ÇãÊôÇ2Ë©±",
                url: "https://note.com/yutapii/n/n_health2",
                date: "2025/08/02",
                pv: 115,
                likes: 6,
                comments: 0
            },
            {
                title: "ÂÅ•Â∫∑„ÅåËª¢ËêΩ„Åô„ÇãÊôÇ5Ë©±",
                url: "https://note.com/yutapii/n/n_health5",
                date: "2025/08/01",
                pv: 112,
                likes: 4,
                comments: 0
            },
            {
                title: "OpenAIÂàù„ÅÆ„Ç™„Éº„Éó„É≥„ÇΩ„Éº„Çπ„É¢„Éá„É´„ÄåGPT-OSS-20b„ÄçÂæπÂ∫ïËß£Ë™¨ - Ëá™ÂÆÖPC„ÅßÂãï„Åè‚Ä¶",
                url: "https://note.com/yutapii/n/nffa3797f88c3",
                date: "2025/08/06",
                pv: 60,
                likes: 0,
                comments: 0
            },
            {
                title: "NTT„Éá„Éº„Çø„ÄÅGLMistral AI„Å®Ê•≠ÂãôÊèêÊê∫ ‚Äî Ë≥áÊú¨„Å™„Åç„ÄåÂÖ±ÂêåÂ±ïÈñã„Äç„ÅÆËôöÂÆü",
                url: "https://note.com/yutapii/n/n1c4f60ba3bc3",
                date: "2025/08/05",
                pv: 17,
                likes: 0
            },
            {
                title: "Êó•Á±≥ÂêàÊÑè„Åã„ÇâÁ¥êËß£„ÅèAIÁ´∂‰∫â„ÅÆÂÖ®Ë≤å",
                url: "https://note.com/yutapii/n/n0c7e46ae6a78",
                date: "2025/08/04",
                pv: 14,
                likes: 2
            },
            {
                title: "note„Ç§„É≥„Éù„Éº„ÉàÁî®WXR„Éï„Ç°„Ç§„É´‰ΩúÊàê„Éû„Éã„É•„Ç¢„É´(ÂÆåÂÖ®Áâà)",
                url: "https://note.com/yutapii/n/nba8f85ad31a3",
                date: "2025/08/02",
                pv: 11,
                likes: 0
            },
            {
                title: "PerplexityË®ò‰∫ã„ÅÆ„Ç§„É≥„Éù„Éº„Éà",
                url: "https://note.com/yutapii/n/n860a3d1c6a13",
                date: "2025/08/01",
                pv: 9,
                likes: 0
            },
            {
                title: "NVIDIA„ÅÆÁâπË®±„ÇíÂÆåÂÖ®ÁÑ°Ë¶ñÔºÅAMD„Å®Intel„Åå‰ªïÊéõ„Åë„ÇãÊ¨°‰∏ñ‰ª£ÊäÄË°ìÈù©ÂëΩ„ÅÆÂÖ®Ë≤å",
                url: "https://note.com/yutapii/n/nd0f48e0e91d0",
                date: "2025/07/31",
                pv: 5,
                likes: 3
            },
            {
                title: "„Éº„ÉºPerplexity Pages_„Äê2025ÊúÄÊñ∞Áâà„Äë„Ç¢„Éó„É™„ÅÆÂü∫Êú¨„Å®ÂøúÁî®„Åæ„ÅßÂÆåÂÖ®Ëß£Ë™¨„Éº",
                url: "https://note.com/yutapii/n/n33b0dccc5a20",
                date: "2025/07/30",
                pv: 4,
                likes: 1
            },
            {
                title: "Perplexity Pages",
                url: "https://note.com/yutapii/n/n69f3fb1e0b6b",
                date: "2025/07/30",
                pv: 2,
                likes: 0
            },
            {
                title: "„ÄêGPT-5„ÅÆÁúüÂÆü„Äë2025Âπ¥„ÅÆÊúüÂæÖ„Å®ÁèæÂÆü - ÁßÅ„Åü„Å°„ÅØ‰Ωï„ÇíÂæÖ„Å£„Å¶„ÅÑ„Çã„ÅÆ„Åã",
                url: "https://note.com/yutapii/n/n27b7e0bbba81",
                date: "2025/07/29",
                pv: 8,
                likes: 0
            },
            {
                title: "„ÄêÊó•ÂàäAI„ÇÜ„Åü„Åï„ÇìÊñ∞ËÅû„Äë2025Âπ¥7Êúà28Êó•Âè∑ - AIÊäïË≥á„Éñ„Éº„É†ÁµÇÁÑâ„ÅÆË≠¶Âëä",
                url: "https://note.com/yutapii/n/n088f088e8e4f",
                date: "2025/07/28",
                pv: 3,
                likes: 7
            },
            {
                title: "„ÄêÊó•ÂàäAI„ÇÜ„Åü„Åï„ÇìÊñ∞ËÅû„Äë2025Âπ¥7Êúà27Êó•Âè∑ - „É°„Çø„ÅåAIÁ†îÁ©∂ÊâÄ„ÇíÊó•Êú¨„Å´Ë®≠Á´ã„Åã",
                url: "https://note.com/yutapii/n/n5e4ab3ba6819",
                date: "2025/07/27",
                pv: 1,
                likes: 0
            },
            {
                title: "Êó•ÂàäAI„ÇÜ„Åü„Åï„ÇìÊñ∞ËÅû_7/26(ÈáëÊõúÊó•)Âè∑„ÄÄÈÄ±Êú´ÁâπÂ§ßÂè∑ÔºöAI„Ç®„Éº„Ç∏„Çß„É≥„ÉàÂÖÉÂπ¥",
                url: "https://note.com/yutapii/n/nff2c3e2e1d88",
                date: "2025/07/26",
                pv: 2,
                likes: 0
            },
            {
                title: "Êó•ÂàäAI„ÇÜ„Åü„Åï„ÇìÊñ∞ËÅû_2025/7/25Êú®ÊõúÊó•Âè∑„ÄÇÊú¨Êó•„ÅÆ„ÉÜ„Éº„ÉûÔºöGPT-5„ÄåÊ¨°‰∏ñ‰ª£„Äç",
                url: "https://note.com/yutapii/n/nccd7e86e2aff",
                date: "2025/07/25",
                pv: 0,
                likes: 0
            },
            {
                title: "Êó•ÂàäAI„ÇÜ„Åü„Åï„ÇìÊñ∞ËÅû_2025/7/24Ê∞¥ÊõúÊó•Âè∑„ÄÇÊú¨Êó•„ÅÆAIË¶ÅÁ¥ÑÔºö",
                url: "https://note.com/yutapii/n/ncc6f0e0b10f0",
                date: "2025/07/24",
                pv: 3,
                likes: 0
            },
            {
                title: "Êó•ÂàäAI„ÇÜ„Åü„Åï„ÇìÊñ∞ËÅûÔºö2025Âπ¥7Êúà23Êó•(ÁÅ´)Âè∑",
                url: "https://note.com/yutapii/n/n3f73e959c2a9",
                date: "2025/07/23",
                pv: 1,
                likes: 0
            }
        ];

        // Ë®ò‰∫ã„ÉÜ„Éº„Éñ„É´„ÇíÊèèÁîª
        function renderTable() {
            const tbody = document.getElementById('articlesBody');
            tbody.innerHTML = articles.map((article, index) => `
                <tr>
                    <td class="checkbox-col">
                        <input type="checkbox" class="article-checkbox" data-index="${index}">
                    </td>
                    <td class="article-title" title="${article.title}">${article.title}</td>
                    <td class="article-date">${article.date}</td>
                    <td>
                        <input type="number" class="editable-input" value="${article.pv}" 
                               onchange="updatePV(${index}, this.value)">
                    </td>
                    <td>
                        <input type="number" class="editable-input" value="${article.likes}" 
                               onchange="updateLikes(${index}, this.value)">
                    </td>
                    <td>${article.pv > 0 ? ((article.likes / article.pv) * 100).toFixed(1) : 0}%</td>
                    <td>
                        <button class="edit-btn" onclick="editArticle(${index})">Á∑®ÈõÜ</button>
                    </td>
                </tr>
            `).join('');
            
            updateStats();
        }

        // PVÊõ¥Êñ∞
        function updatePV(index, value) {
            articles[index].pv = parseInt(value) || 0;
            renderTable();
        }

        // „Çπ„Ç≠Êõ¥Êñ∞
        function updateLikes(index, value) {
            articles[index].likes = parseInt(value) || 0;
            renderTable();
        }

        // Áµ±Ë®àÊõ¥Êñ∞
        function updateStats() {
            const totalPV = articles.reduce((sum, a) => sum + a.pv, 0);
            const totalLikes = articles.reduce((sum, a) => sum + a.likes, 0);
            const avgPV = (totalPV / articles.length).toFixed(1);
            const avgLikes = (totalLikes / articles.length).toFixed(1);
            const likeRate = totalPV > 0 ? ((totalLikes / totalPV) * 100).toFixed(1) : 0;
            
            document.getElementById('totalPV').textContent = totalPV;
            document.getElementById('totalLikes').textContent = totalLikes;
            document.getElementById('avgPV').textContent = avgPV;
            document.getElementById('avgLikes').textContent = avgLikes;
            document.getElementById('likeRate').textContent = likeRate + '%';
        }

        // ÂÖ®ÈÅ∏Êäû„Éà„Ç∞„É´
        function toggleSelectAll() {
            const selectAll = document.getElementById('selectAll');
            document.querySelectorAll('.article-checkbox').forEach(cb => {
                cb.checked = selectAll.checked;
            });
        }

        // ‰∏ÄÊã¨Á∑®ÈõÜ„Éë„Éç„É´Ë°®Á§∫ÂàáÊõø
        function toggleBulkEdit() {
            document.getElementById('bulkEditPanel').classList.toggle('active');
        }

        // ‰∏ÄÊã¨Á∑®ÈõÜÈÅ©Áî®
        function applyBulkEdit() {
            const pv = document.getElementById('bulkPV').value;
            const likes = document.getElementById('bulkLikes').value;
            
            document.querySelectorAll('.article-checkbox:checked').forEach(cb => {
                const index = parseInt(cb.dataset.index);
                if (pv) articles[index].pv = parseInt(pv);
                if (likes) articles[index].likes = parseInt(likes);
            });
            
            renderTable();
            toggleBulkEdit();
        }

        // „É©„É≥„ÉÄ„É†„Éá„Éº„ÇøÁîüÊàê
        function randomizeData() {
            articles.forEach(article => {
                article.pv = Math.floor(Math.random() * 500) + 10;
                article.likes = Math.floor(Math.random() * Math.min(50, article.pv * 0.3));
            });
            renderTable();
        }

        // „Éá„Éº„Çø„É™„Çª„ÉÉ„Éà
        function resetData() {
            articles.forEach(article => {
                article.pv = 0;
                article.likes = 0;
            });
            renderTable();
        }

        // PVÈ†Ü„ÇΩ„Éº„Éà
        function sortByPV() {
            articles.sort((a, b) => b.pv - a.pv);
            renderTable();
        }

        // „Çπ„Ç≠È†Ü„ÇΩ„Éº„Éà
        function sortByLikes() {
            articles.sort((a, b) => b.likes - a.likes);
            renderTable();
        }

        // Êó•‰ªòÈ†Ü„ÇΩ„Éº„Éà
        function sortByDate() {
            articles.sort((a, b) => new Date(b.date) - new Date(a.date));
            renderTable();
        }

        // RSSÂêåÊúü
        function syncRSS() {
            alert('RSS„Åã„ÇâÊúÄÊñ∞„Éá„Éº„Çø„ÇíÂèñÂæó‰∏≠...\n\nÂÆüÈöõ„ÅÆÂÆüË£Ö„Åß„ÅØ:\n1. note.com/yutapii/rss „Çífetch\n2. XML„Çí„Éë„Éº„Çπ\n3. Ë®ò‰∫ã„É™„Çπ„Éà„ÇíÊõ¥Êñ∞');
        }

        // JSON „Ç®„ÇØ„Çπ„Éù„Éº„Éà
        function exportJSON() {
            const data = {
                exportDate: new Date().toISOString(),
                source: 'note.com/yutapii/rss',
                articles: articles,
                stats: {
                    totalPV: articles.reduce((sum, a) => sum + a.pv, 0),
                    totalLikes: articles.reduce((sum, a) => sum + a.likes, 0)
                }
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `note-analytics-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }

        // CSV „Ç®„ÇØ„Çπ„Éù„Éº„Éà
        function exportCSV() {
            let csv = '„Çø„Ç§„Éà„É´,URL,ÂÖ¨ÈñãÊó•,PVÊï∞,„Çπ„Ç≠Êï∞,„Çπ„Ç≠Áéá\n';
            articles.forEach(article => {
                const likeRate = article.pv > 0 ? ((article.likes / article.pv) * 100).toFixed(1) : 0;
                csv += `"${article.title}","${article.url}","${article.date}",${article.pv},${article.likes},${likeRate}%\n`;
            });
            
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `note-analytics-${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            URL.revokeObjectURL(url);
        }

        // Markdown „Ç®„ÇØ„Çπ„Éù„Éº„Éà
        function exportMarkdown() {
            let md = '# note.com Ë®ò‰∫ãÂàÜÊûê„É¨„Éù„Éº„Éà\n\n';
            md += `ÁîüÊàêÊó•: ${new Date().toLocaleString('ja-JP')}\n\n`;
            md += '## Áµ±Ë®à„Çµ„Éû„É™„Éº\n\n';
            md += `- Á∑èPVÊï∞: ${articles.reduce((sum, a) => sum + a.pv, 0)}\n`;
            md += `- Á∑è„Çπ„Ç≠Êï∞: ${articles.reduce((sum, a) => sum + a.likes, 0)}\n\n`;
            md += '## Ë®ò‰∫ã‰∏ÄË¶ß\n\n';
            md += '| „Çø„Ç§„Éà„É´ | PV | „Çπ„Ç≠ | „Çπ„Ç≠Áéá |\n';
            md += '|---------|----:|-----:|-------:|\n';
            
            articles.forEach(article => {
                const likeRate = article.pv > 0 ? ((article.likes / article.pv) * 100).toFixed(1) : 0;
                md += `| ${article.title.substring(0, 40)}... | ${article.pv} | ${article.likes} | ${likeRate}% |\n`;
            });
            
            const blob = new Blob([md], { type: 'text/markdown;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `note-analytics-${new Date().toISOString().split('T')[0]}.md`;
            a.click();
            URL.revokeObjectURL(url);
        }

        // ÂÄãÂà•Á∑®ÈõÜ
        function editArticle(index) {
            const article = articles[index];
            const pv = prompt('PVÊï∞„ÇíÂÖ•Âäõ:', article.pv);
            const likes = prompt('„Çπ„Ç≠Êï∞„ÇíÂÖ•Âäõ:', article.likes);
            
            if (pv !== null) article.pv = parseInt(pv) || 0;
            if (likes !== null) article.likes = parseInt(likes) || 0;
            
            renderTable();
        }

        // ÂàùÊúüÂåñ
        window.addEventListener('load', () => {
            renderTable();
        });
    </script>
</body>
</html>